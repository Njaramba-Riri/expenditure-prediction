{% extends 'base.html' %}

{% block title %}LetsGo | User Profile {% endblock %}

{% block content %}
<div class="view-profile">
    <div class="user-profile">
		<div class="header">
			<h2>{{ user.username | title }} Profile</h2>
		</div>
        <div class="user-info">
            <div class="bleep">
                {% if user.gravatar %}
                    <img src="{{ user.gravatar(256) }}">
                {% else %}
                    <ion-icon name="person-outline"></ion-icon>
                {% endif %}     
                <div class="action-btns">
                    <button type="submit" onclick="toEdit()" id="edit">Edit</button>
                    <button type="submit" onclick="toBack()" id="close">Back</button>
                </div>                 
            </div>
            <div class="info-card">
                <div class="info">
                    <p>Email: <span><a href="mailto:{{ user.email }}">{{ user.email }}</a></span></p>
                </div>
                <div class="info">
                    <p>Username: <span>{{ user.username }}</span></p>
                </div>
                <div class="info">
                    <p>User Role: <span>{{ user.role }}</span></p>
                </div>
                {% if user.mobile %}
                    <div class="info">
                        <p>Mobile: <span>{{ user.mobile }}</span></p>
                    </div>
                {% endif %}
                {% if user.location %}
                    <div class="info">
                        <p>Location: 
                            <span>
                                <a href="www.googlemaps/?q={{ user.location }}">{{ user.location }}</a>
                            </span>
                        </p>
                    </div>
                {% endif %} 
                {% if user.about %}
                    <div class="info">
                        <p>Bio: <span>{{ user.about }}</span></p>
                    </div>
                {% endif %} 
                {% if user.tour_company %}
                    <div class="info">
                        <p>Tour Company: <span>{{ user.tour_company }}</span></p>
                    </div>
                {% endif %} 
                {% if user.company_email %}
                    <div class="info">
                        <p>Company Email: <span>{{ user.company_email }}</span></p>
                    </div>
                {% endif %}
                {% if user.company_mobile %}
                    <div class="info">
                        <p>Company Mobile: <span>{{ user.company_mobile }}</span></p>
                    </div>
                {% endif %}
                {% if user.company_address %}
                    <div class="info">
                        <p>Company Address: <span>{{ user.company_address }}</span></p>
                    </div>
                {% endif %}
                <div class="info">
                    <p>Account creation: 
                        <span>{{ moment(user.date_created).format('LL') }}</span> 
                    </p>
                </div>
                <div class="info">
                    <p>Last Seen: 
                        <span>{{ moment(user.last_seen).format('LL') }} ({{moment(user.last_seen).fromNow()}})</span> 
                    </p>
                </div>
                {% if user.confirmed == True %}
                    <div class="info">
                        <p>Account Status: <span>Confirmed</span></p>
                    </div>
                {% else %}
                <div class="info">
                    <p>Account Status: <span>Unconfirmed</span></p>
                </div>
                {% endif %}
            </div>
        </div>
	</div>
</div>
{% endblock %}
{% block js %}
    {{ super() }}
    {{ moment.include_moment() }}
    <script>
        const back = document.getElementById('close');
        const edit = document.getElementById('edit');

        if (back){
            back.addEventListener('click', (event) => {
                window.history.back();
            });
        }

        if(edit){
            edit.addEventListener('click', (event) => {
                window.location.href = "{{ url_for('.update_profile', username=user.username)}}";
            });
        }
    </script>
{% endblock %}