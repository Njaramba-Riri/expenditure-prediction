{% extends 'base.html' %}

{% block title %} LetsGo | Prediction Results {% endblock %}

{% block content %}
{% include 'include/navigation.html' %}
<section class="results">
    <div class="result">
        <div class="predictions">
            <h1>What we've got?.</h1>
            <p>Here's your predictions...</p>        
            <div class="another-box">
                <p>From the <button onclick="showDetails()" id="details"> details</button> that you have provided, your spending category alongside your predicted total cost will be as follows: </p>
                <div class="predicted">
                    <h4>Cost Category: <span>{{ predicted_result }}.</span> </h4>
                    <h4>Total Cost: <span>KES 132, 765.</span></h4>
                    <h4>Probability: <span>{{ "%.2f" | format(probability) }} %.</span></h4>
                </div>
                <div class="details" id="features">
                    {% if features %}
                    <div class="features">
                        <p>Country: <strong>{{ features[0] }}</strong></p>
                        <p>Age group: <strong>{{ features[1] }}</strong></p>
                        <p>Travel with: <strong>{{ features[2] }}</strong></p>
                        <p>Total male: <strong>{{ features[3] }}</strong></p>
                        <p>Total female: <strong>{{ features[4] }}</strong></p>
                        <p>Tour purpose: <strong>{{ features[5] }}</strong></p>
                        <p>Main activity: <strong>{{ features[6] }}</strong></p>
                        <p>Info source: <strong>{{ features[7] }}</strong></p>
                        <p>Arrangement: <strong>{{ features[8] }}</strong></p>
                        <p>Int transport: <strong>{{ features[9] }}</strong></p>
                        <p>Tnz transport: <strong>{{ features[10] }}</strong></p>
                        <p>Accomodation: <strong>{{ features[11] }}</strong></p>
                        <p>Food: <strong>{{ features[12] }}</strong></p>
                        <p>Sightseeing: <strong>{{ features[13] }}</strong></p>
                        <p>Guided tour: <strong>{{ features[14] }}</strong></p>
                        <p>Package insurance: <strong>{{ features[15] }}</strong></p>
                        <p>Nights mainland: <strong>{{ features[16] }}</strong></p>
                        <p>Nights Zanzibar: <strong>{{ features[17] }}</strong></p>
                        <p>First time: <strong>{{ features[18] }}</strong></p>                        
                    </div>
                    {% endif %}
                </div>
                <div class="mawoni">
                    <p>A quick one, how do you feel about the predictions?.</p>
                    <div class="ions">
                        <ion-icon name="thumbs-up-outline" title="Satisfied" 
                        onclick="showMessage('We are happy you liked the prediction!.')"></ion-icon> 
                        <ion-icon name="happy-outline" title="Neutral" 
                        onclick="showMessage('We will take that, tuko happy sana.')"></ion-icon>
                        <ion-icon name="thumbs-down-outline" title="Disatisfied." onclick="unhappyFeed()" id="Disatisfied"></ion-icon> 
                        <form action="{{ url_for('.predict') }}" method="post">
                            {% for field in form %}
                                <div class="user-mawoni" id="mawoni">
                                    {% if field.type == 'TextAreaField' %}
                                        {{ field(class_='input', placeholder=field.label.text) }}
                                    {% else %}
                                        {{ field(class_='send-btn') }}
                                    {% endif %}                                    
                                </div>
                            {% endfor %}
                        </form>  
                        <div id="feed-modal">
                            <div class="feed-content">
                                <span class="close">&times;</span>
                                <p id="modalText"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="recommended">
            {% if current_user.is_authenticated %}
                <h2>{{ current_user.username | title }}, All within your budget.</h2>
            {% else %}
                <h2>All within your budget. It's all yours.</h2>
            {% endif %}
            <div class="places">
                <ul class="gallery">                
                    <li>
                        <figure>
                            <a href=""><img src="/static/images/maasai.jpeg" alt="" srcset=""></a>
                            <figcaption>
                                <main>
                                    <p class="">
                                        <span><i class="fa fa-map-marker"></i>Mara</span>
                                        <span><i class="fa fa-sun"></i>4 Days</span>
                                        <span><i class="fa fa-moon"></i>3 Nights</span>
                                    </p>
                                    <h3>Maasai Mara</h3>
                                    <p>
                                        Experience an authentic encounter with the Maasai community, 
                                        renowned for their cultural richness and unique way of life  
                                    </p>
                                </main>
                                <footer>
                                    <div>
                                        <p class="small">From</p>
                                        <p class="price">$300</p>
                                        <i class="fa fa-arrow-right"></i>
                                    </div>
                                </footer>
                            </figcaption>
                        </figure>
                    </li> 
                    <li>
                        <figure>
                            <a href=""><img src="/static/images/ele.jpg" alt=""></a>
                            <figcaption>
                                <main>
                                    <p>                        
                                        <span><i class="fa fa-map-marker"></i>Serengeti</span>
                                        <span><i class="fa fa-sun"></i>4 Days</span>
                                        <span><i class="fa fa-moon"></i>3 Nights</span>
                                    </p>
                                    <h3>Serengeti</h3>
                                    <p>Book your safari today and get ready to be awed by the beauty of the African savannah!</p>
                                </main>
                                <footer>
                                    <div>
                                        <p class="small">From</p>
                                        <p class="price">$100</p>
                                        <i class="fa fa-arrow-right"></i>
                                    </div>
                                </footer>
                            </figcaption>
                        </figure>
                    </li> 
                </ul>
            </div>
            <div class="btn-activity">
                {% if current_user.is_authenticated %}
                    <button type="button" class="activity-btn" onclick="toActivity()">Discover More.</button>
                {% else %}
                    <button type="button" class="activity-btn" onclick="toSign()">Sign In to Discover More.</button>
                {% endif  %}                
            </div>            
        </div>        
    </div>
</section>
<section class="teaser">
    <div class="another">
        <div class="row">
            <h3> Feels like a rollercoaster?.</h3>
            <p>Give it another try?.</p>
            <div class="btns">
                <button type="button" onclick="toForm()" class="result-btn">Of Course.</button>
                <button type="button" onclick="toThanks()" class="result-btn">I'm good.</button>                
            </div>
        </div>
    </div>
</section>
{% include 'include/footer.html' %}
<script>
    function showMessage(message){
        document.getElementById("modalText").innerText = message;
        modal.style.display = "block";
    }

    close.onclick = function(){
        modal.style.display = "none";
    }
  
    window.onclick = function(event){
        if (event.target == modal){
        modal.style.display = "none";
        }
    }
    function happyFeed(){
        alert("Thank you for that and thank you for your time.")
    }
    function neutralFeed(){
        alert("We'll take that. Thank you for your feedback.")
    }
    // function unhappyFeed(){
    //     alert("We feel sorry for that. Thank you for helping us get feedback.")
    // }
    function toActivity(){
        window.location.href = "{{ url_for('suser.activity', username=current_user.username) }}"
    }
    function toSign(){
        window.location.href = "{{ url_for('auth.signin') }}"
    }
    function toForm(){
        window.location.href = "{{ url_for('app.form') }}"
    }
    function toThanks(){
        window.location.href = "{{ url_for('app.thanks') }}"
    }

    var showDetails = document.getElementById("features")
    showDetails.addEventListener('click', function(){
        showDetails.classList.add('features-show')
    })
</script>
{% endblock %}